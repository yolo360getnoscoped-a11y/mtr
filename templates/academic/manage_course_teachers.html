{% extends 'base_dashboard.html' %}

{% block title %}จัดการอาจารย์ผู้สอน - {{ course.course_code }}{% endblock %}

{% block content %}
<div class="page-header">
    <h1>จัดการอาจารย์ผู้สอน</h1>
    <p style="color: #666; margin-top: 0.5rem;">{{ course.course_code }} - {{ course.course_name }}</p>
</div>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }}" style="margin-bottom: 1rem; padding: 1rem; border-radius: 4px; background-color: {% if message.tags == 'error' %}#f8d7da{% elif message.tags == 'success' %}#d4edda{% else %}#d1ecf1{% endif %}; color: {% if message.tags == 'error' %}#721c24{% elif message.tags == 'success' %}#155724{% else %}#0c5460{% endif %};">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<div class="form-container">
    <form method="post">
        {% csrf_token %}
        
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>กลุ่มเรียน</th>
                        <th>ภาคเรียน</th>
                        <th>อาจารย์ผู้สอนปัจจุบัน</th>
                        <th>เลือกอาจารย์ผู้สอน</th>
                    </tr>
                </thead>
                <tbody>
                    {% for section in sections %}
                    <tr>
                        <td>
                            <strong>กลุ่ม {{ section.section_number }}</strong>
                            {% if section.room %}
                                <br><small style="color: #666;">ห้อง: {{ section.room }}</small>
                            {% endif %}
                            {% if section.schedule %}
                                <br><small style="color: #666;">{{ section.schedule }}</small>
                            {% endif %}
                        </td>
                        <td>{{ section.semester }}</td>
                        <td>
                            {% if section.teacher %}
                                {{ section.teacher.get_full_name|default:section.teacher.username }}
                            {% else %}
                                <span style="color: #999;">ยังไม่กำหนดอาจารย์</span>
                            {% endif %}
                        </td>
                        <td>
                            <select name="teacher_{{ section.id }}" class="form-control" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="none">-- ไม่กำหนดอาจารย์ --</option>
                                {% for teacher in teachers %}
                                <option value="{{ teacher.id }}" {% if section.teacher.id == teacher.id %}selected{% endif %}>
                                    {{ teacher.get_full_name|default:teacher.username }}
                                </option>
                                {% endfor %}
                            </select>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center">ยังไม่มีกลุ่มเรียนสำหรับรายวิชานี้</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="form-actions" style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
            <a href="{% url 'academic:course_list' %}" class="btn btn-secondary">ยกเลิก</a>
            <button type="submit" class="btn btn-primary">บันทึกการเปลี่ยนแปลง</button>
        </div>
    </form>
</div>

<style>
.form-container {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.form-control {
    font-size: 0.95rem;
}

.btn {
    padding: 0.75rem 1.5rem;
    border-radius: 4px;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s;
    border: none;
    cursor: pointer;
    font-size: 1rem;
    display: inline-block;
}

.btn-primary {
    background-color: #0066cc;
    color: white;
}

.btn-primary:hover {
    background-color: #0052a3;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background-color: #545b62;
}
</style>
{% endblock %}

