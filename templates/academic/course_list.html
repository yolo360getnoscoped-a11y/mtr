{% extends 'base_dashboard.html' %}

{% block title %}จัดการรายวิชา{% endblock %}

{% block content %}
<div class="page-header">
    <h1>จัดการรายวิชา</h1>
    <a href="{% url 'academic:course_add' %}" class="btn btn-primary">เพิ่มรายวิชาใหม่</a>
</div>

<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>รหัสวิชา</th>
                <th>ชื่อวิชา</th>
                <th>หน่วยกิต</th>
                <th>ชื่ออาจารย์ผู้สอน</th>
                <th>จำนวนนักเรียน</th>
                <th>จัดการ</th>
            </tr>
        </thead>
        <tbody>
            {% for item in courses_with_info %}
            <tr>
                <td>{{ item.course.course_code }}</td>
                <td>{{ item.course.course_name }}</td>
                <td>{{ item.course.credit }}</td>
                <td>
                    {% if item.teachers %}
                        {% for teacher in item.teachers %}
                            {{ teacher.get_full_name|default:teacher.username }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    {% else %}
                        <span style="color: #999;">ยังไม่กำหนดอาจารย์</span>
                    {% endif %}
                </td>
                <td>{{ item.total_students }}</td>
                <td>
                    <a href="{% url 'academic:course_detail' item.course.id %}" class="btn btn-sm btn-view">ดูรายละเอียด</a>
                    <a href="{% url 'academic:course_edit' item.course.id %}" class="btn btn-sm btn-edit">แก้ไข</a>
                    <a href="{% url 'academic:course_delete' item.course.id %}" class="btn btn-sm" style="background: #dc3545; color: white;" onclick="return confirm('คุณแน่ใจหรือไม่ว่าต้องการลบรายวิชา {{ item.course.course_code }}?')">ลบ</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center">ยังไม่มีรายวิชา</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

